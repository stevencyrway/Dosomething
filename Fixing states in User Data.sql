Select northstar_id,
       created_at,
       club_id,
       last_logged_in,
       last_accessed,
       last_messaged_at,
       drupal_uid,
       source,
       email,
       email_subscription_topics,
       facebook_id,
       mobile,
       birthdate,
       first_name,
       last_name,
       voter_registration_status,
       address_street_1,
       address_street_2,
       city,
                 case
               when lower(trim(state)) = 'al - alabama' then 'AL'
               when lower(trim(state)) = 'alabama' then 'AL'
               when lower(trim(state)) = 'ariz' then 'AZ'
               when lower(trim(state)) = 'arizon' then 'AZ'
               when lower(trim(state)) = 'arizona' then 'AZ'
               when lower(trim(state)) = 'az -' then 'AZ'
               when lower(trim(state)) = 'az.' then 'AZ'
               when lower(trim(state)) = 'az' then 'AZ'
               when lower(trim(state)) = 'az - arizona' then 'AZ'
               when lower(trim(state)) = 'arkansas' then 'AR'
               when lower(trim(state)) = 'arka' then 'AR'
               when lower(trim(state)) = 'ark' then 'AR'
               when lower(trim(state)) = 'ca - california' then 'CA'
               when lower(trim(state)) = 'ca - california [usa]' then 'CA'
               when lower(trim(state)) = 'ca-c' then 'CA'
               when lower(trim(state)) = 'ca' then 'CA'
               when lower(trim(state)) = 'ca.' then 'CA'
               when lower(trim(state)) = 'ca -' then 'CA'
               when lower(trim(state)) = 'cali' then 'CA'
               when lower(trim(state)) = 'calif' then 'CA'
               when lower(trim(state)) = 'california' then 'CA'
               when lower(trim(state)) = 'califorinia' then 'CA'
               when lower(trim(state)) = 'californa' then 'CA'
               when lower(trim(state)) = 'californi' then 'CA'
               when lower(trim(state)) = 'califorina' then 'CA'
               when lower(trim(state)) = 'california ca' then 'CA'
               when lower(trim(state)) = 'califronia' then 'CA'
               when lower(trim(state)) = 'carlifornia' then 'CA'
               when lower(trim(state)) = 'california (ca)' then 'CA'
               when lower(trim(state)) = 'ca   -   californi' then 'CA'
               when lower(trim(state)) = 'connecticurt' then 'CT'
               when lower(trim(state)) = 'connecticut' then 'CT'
               when lower(trim(state)) = 'conneticut' then 'CT'
               when lower(trim(state)) = 'co' then 'CO'
               when lower(trim(state)) = 'co -' then 'CO'
               when lower(trim(state)) = 'co.' then 'CO'
               when lower(trim(state)) = 'colorado' then 'CO'
               when lower(trim(state)) = 'delaware' then 'DE'
               when lower(trim(state)) = 'guam' then 'GU'
               when lower(trim(state)) = 'district of columbia' then 'DC'
               when lower(trim(state)) = 'fl' then 'FL'
               when lower(trim(state)) = 'fl -' then 'FL'
               when lower(trim(state)) = 'fl.' then 'FL'
               when lower(trim(state)) = 'fl florida' then 'FL'
               when lower(trim(state)) = 'fl - florida' then 'FL'
               when lower(trim(state)) = 'fl: florida' then 'FL'
               when lower(trim(state)) = 'flor' then 'FL'
               when lower(trim(state)) = 'flordia' then 'FL'
               when lower(trim(state)) = 'florida' then 'FL'
               when lower(trim(state)) = 'florida fl' then 'FL'
               when lower(trim(state)) = 'fl florida (fl)' then 'FL'
               when lower(trim(state)) = 'ga - georgia' then 'GA'
               when lower(trim(state)) = 'ga' then 'GA'
               when lower(trim(state)) = 'ga -' then 'GA'
               when lower(trim(state)) = 'georgia' then 'GA'
               when lower(trim(state)) = 'ga - georgia' then 'GA'
               when lower(trim(state)) = 'ga - georgia' then 'GA'
               when lower(trim(state)) = 'hawalli' then 'HI'
               when lower(trim(state)) = 'hawaii' then 'HI'
               when lower(trim(state)) = 'hi - hawaii' then 'HI'
               when lower(trim(state)) = 'hi - hawaii [usa]' then 'HI'
               when lower(trim(state)) = 'hawaii' then 'HI'
               when lower(trim(state)) = 'hawaii' then 'HI'
               when lower(trim(state)) = 'idaho' then 'ID'
               when lower(trim(state)) = 'idah' then 'ID'
               when lower(trim(state)) = 'iowa' then 'IA'
               when lower(trim(state)) = 'il - illinois' then 'IL'
               when lower(trim(state)) = 'il-illinois' then 'IL'
               when lower(trim(state)) = 'illinios' then 'IL'
               when lower(trim(state)) = 'illinoi' then 'IL'
               when lower(trim(state)) = 'illinois' then 'IL'
               when lower(trim(state)) = 'illinoise' then 'IL'
               when lower(trim(state)) = 'illinois il' then 'IL'
               when lower(trim(state)) = 'illinois' then 'IL'
               when lower(trim(state)) = 'indiana' then 'IN'
               when lower(trim(state)) = 'indiana' then 'IN'
               when lower(trim(state)) = 'in - indiana' then 'IN'
               when lower(trim(state)) = 'indiana (in)' then 'IN'
               when lower(trim(state)) = 'kentucky' then 'KY'
               when lower(trim(state)) = 'kentucky (ky)' then 'KY'
               when lower(trim(state)) = 'kansas' then 'KS'
               when lower(trim(state)) = 'kansas [ks]' then 'KS'
               when lower(trim(state)) = 'la - louisiana' then 'LA'
               when lower(trim(state)) = 'louisianna' then 'LA'
               when lower(trim(state)) = 'lousiiana' then 'LA'
               when lower(trim(state)) = 'louisisana' then 'LA'
               when lower(trim(state)) = 'lousiana' then 'LA'
               when lower(trim(state)) = 'louisiana' then 'LA'
               when lower(trim(state)) = 'Iowa' then 'IA'
               when lower(trim(state)) = 'massachussetts' then 'MA'
               when lower(trim(state)) = 'massachusetts' then 'MA'
               when lower(trim(state)) = 'maryland' then 'MD'
               when lower(trim(state)) = 'maryland md' then 'MD'
               when lower(trim(state)) = 'maryland (md)' then 'MD'
               when lower(trim(state)) = 'marylang' then 'MD'
               when lower(trim(state)) = 'md - maryland' then 'MD'
               when lower(trim(state)) = 'md - maryland [usa]' then 'MD'
               when lower(trim(state)) = 'michigan' then 'MI'
               when lower(trim(state)) = 'michian' then 'MI'
               when lower(trim(state)) = 'michigan' then 'MI'
               when lower(trim(state)) = 'michigan (mi)' then 'MI'
               when lower(trim(state)) = 'michigan [mi]' then 'MI'
               when lower(trim(state)) = 'mn - minnesota' then 'MN'
               when lower(trim(state)) = 'minnesota' then 'MN'
               when lower(trim(state)) = 'minnesota (mn)' then 'MN'
               when lower(trim(state)) = 'missisippi' then 'MP'
               when lower(trim(state)) = 'ms - mississippi' then 'MP'
               when lower(trim(state)) = 'mississippi' then 'MP'
               when lower(trim(state)) = 'misouri' then 'MS'
               when lower(trim(state)) = 'missouri' then 'MS'
               when lower(trim(state)) = 'mo - missouri' then 'MS'
               when lower(trim(state)) = 'mt' then 'MT'
               when lower(trim(state)) = 'mt - montana' then 'MT'
               when lower(trim(state)) = 'montana' then 'MT'
               when lower(trim(state)) = 'maine' then 'ME'
               when lower(trim(state)) = 'n.c' then 'NC'
               when lower(trim(state)) = 'n.c.' then 'NC'
               when lower(trim(state)) = 'n. carolina' then 'NC'
               when lower(trim(state)) = 'nc - north carolina' then 'NC'
               when lower(trim(state)) = 'nc north carolina' then 'NC'
               when lower(trim(state)) = 'nebraska' then 'NE'
               when lower(trim(state)) = 'nd - north dakota' then 'ND'
               when lower(trim(state)) = 'ne -' then 'NE'
               when lower(trim(state)) = 'new hampshire' then 'NH'
               when lower(trim(state)) = 'n.dak' then 'ND'
               when lower(trim(state)) = 'nevada' then 'NV'
               when lower(trim(state)) = 'newjersey' then 'NJ'
               when lower(trim(state)) = 'new jersey' then 'NJ'
               when lower(trim(state)) = 'new-jersey' then 'NJ'
               when lower(trim(state)) = 'new jersey (nj)' then 'NJ'
               when lower(trim(state)) = 'new mexcio' then 'NM'
               when lower(trim(state)) = 'new mexico' then 'NM'
               when lower(trim(state)) = 'new mexico (nm)' then 'NM'
               when lower(trim(state)) = 'newyork' then 'NY'
               when lower(trim(state)) = 'new york' then 'NY'
               when lower(trim(state)) = 'new york (ny)' then 'NY'
               when lower(trim(state)) = 'new mexico' then 'NM'
               when lower(trim(state)) = 'n.h.' then 'NH'
               when lower(trim(state)) = 'nh -' then 'NH'
               when lower(trim(state)) = 'nh - new hampshire' then 'NH'
               when lower(trim(state)) = 'nj - new jersey' then 'NJ'
               when lower(trim(state)) = 'nj-new jersey' then 'NJ'
               when lower(trim(state)) = 'nm - new mexico' then 'NM'
               when lower(trim(state)) = 'north caralina' then 'NC'
               when lower(trim(state)) = 'north carolina' then 'NC'
               when lower(trim(state)) = 'north carolina nc' then 'NC'
               when lower(trim(state)) = 'north carolina (nc)' then 'NC'
               when lower(trim(state)) = 'north carolinas' then 'NC'
               when lower(trim(state)) = 'north caroline' then 'NC'
               when lower(trim(state)) = 'north carolinia' then 'NC'
               when lower(trim(state)) = 'north dakota' then 'ND'
               when lower(trim(state)) = 'ny - new york' then 'NY'
               when lower(trim(state)) = 'ny new york' then 'NY'
               when lower(trim(state)) = 'oh -' then 'OH'
               when lower(trim(state)) = 'ohio' then 'OH'
               when lower(trim(state)) = 'ohio oh' then 'OH'
               when lower(trim(state)) = 'ohip' then 'OH'
               when lower(trim(state)) = 'oh ohio' then 'OH'
               when lower(trim(state)) = 'oh - ohio' then 'OH'
               when lower(trim(state)) = 'ok -' then 'OK'
               when lower(trim(state)) = 'okahoma' then 'OK'
               when lower(trim(state)) = 'oklahoma' then 'OK'
               when lower(trim(state)) = 'oklahoma (ok)' then 'OK'
               when lower(trim(state)) = 'ok - oklahoma' then 'OK'
               when lower(trim(state)) = 'oregon' then 'OR'
               when lower(trim(state)) = 'or' then 'OR'
               when lower(trim(state)) = 'or - oregon' then 'OR'
               when lower(trim(state)) = 'pa - pennsylvania' then 'PA'
               when lower(trim(state)) = 'pa - pennsylvania [usa]' then 'PA'
               when lower(trim(state)) = 'pennslyvania' then 'PA'
               when lower(trim(state)) = 'pennsylvaia' then 'PA'
               when lower(trim(state)) = 'pennsylvainia' then 'PA'
               when lower(trim(state)) = 'pennsylvania (pa)' then 'PA'
               when lower(trim(state)) = 'pennsylvannia' then 'PA'
               when lower(trim(state)) = 'pennsylvvania' then 'PA'
               when lower(trim(state)) = 'rhode island' then 'RI'
               when lower(trim(state)) = 'rhode island ri' then 'RI'
               when lower(trim(state)) = 'ri - rhode island' then 'RI'
               when lower(trim(state)) = 'south caorlina' then 'SC'
               when lower(trim(state)) = 'south carolina' then 'SC'
               when lower(trim(state)) = 'south dakota' then 'SD'
               when lower(trim(state)) = 'teas' then 'TX'
               when lower(trim(state)) = 'teaxas' then 'TX'
               when lower(trim(state)) = 'tenessee' then 'TN'
               when lower(trim(state)) = 'tenn' then 'TN'
               when lower(trim(state)) = 'tennessee' then 'TN'
               when lower(trim(state)) = 'tennesse' then 'TN'
               when lower(trim(state)) = 'tennessee (tn)' then 'TN'
               when lower(trim(state)) = 'texa' then 'TX'
               when lower(trim(state)) = 'texas' then 'TX'
               when lower(trim(state)) = 'texastx' then 'TX'
               when lower(trim(state)) = 'texas tx' then 'TX'
               when lower(trim(state)) = 'texas / tx' then 'TX'
               when lower(trim(state)) = 'texas (tx)' then 'TX'
               when lower(trim(state)) = 'tx -' then 'TX'
               when lower(trim(state)) = 'tx' then 'TX'
               when lower(trim(state)) = 'tx-t' then 'TX'
               when lower(trim(state)) = 'txg' then 'TX'
               when lower(trim(state)) = 'tx texas' then 'TX'
               when lower(trim(state)) = 'tx - texas' then 'TX'
               when lower(trim(state)) = 'tx (texas)' then 'TX'
               when lower(trim(state)) = 'tx-texas' then 'TX'
               when lower(trim(state)) = 'tx - texas [usa]' then 'TX'
               when lower(trim(state)) = 'tx w' then 'TX'
               when lower(trim(state)) = 'twxas' then 'TX'
               when lower(trim(state)) = 'texas' then 'TX'
               when lower(trim(state)) = 'utah' then 'UT'
               when lower(trim(state)) = 'utah (ut)' then 'UT'
               when lower(trim(state)) = '{value: al}' then 'AL'
               when lower(trim(state)) = '{value: ar}' then 'AR'
               when lower(trim(state)) = '{value: az}' then 'AZ'
               when lower(trim(state)) = '{value: ca}' then 'CA'
               when lower(trim(state)) = '{value: co}' then 'CO'
               when lower(trim(state)) = '{value: ct}' then 'CT'
               when lower(trim(state)) = '{value: de}' then 'DE'
               when lower(trim(state)) = '{value: fl}' then 'FL'
               when lower(trim(state)) = '{value: ga}' then 'GA'
               when lower(trim(state)) = '{value: ia}' then 'IA'
               when lower(trim(state)) = '{value: il}' then 'IL'
               when lower(trim(state)) = '{value: in}' then 'IN'
               when lower(trim(state)) = '{value: ks}' then 'KS'
               when lower(trim(state)) = '{value: ky}' then 'KY'
               when lower(trim(state)) = '{value: la}' then 'LA'
               when lower(trim(state)) = '{value: ma}' then 'MA'
               when lower(trim(state)) = '{value: md}' then 'MD'
               when lower(trim(state)) = '{value: mi}' then 'MI'
               when lower(trim(state)) = '{value: mn}' then 'MN'
               when lower(trim(state)) = '{value: mo}' then 'MO'
               when lower(trim(state)) = '{value: ms}' then 'MS'
               when lower(trim(state)) = '{value: nc}' then 'NC'
               when lower(trim(state)) = '{value: ne}' then 'NE'
               when lower(trim(state)) = '{value: nj}' then 'NJ'
               when lower(trim(state)) = '{value: nv}' then 'NV'
               when lower(trim(state)) = '{value: ny}' then 'NY'
               when lower(trim(state)) = '{value: oh}' then 'OH'
               when lower(trim(state)) = '{value: ok}' then 'OK'
               when lower(trim(state)) = '{value: or}' then 'OR'
               when lower(trim(state)) = '{value: pa}' then 'PA'
               when lower(trim(state)) = '{value: sc}' then 'SC'
               when lower(trim(state)) = '{value: sd}' then 'SD'
               when lower(trim(state)) = '{value: tn}' then 'TN'
               when lower(trim(state)) = '{value: tx}' then 'TX'
               when lower(trim(state)) = '{value: ut}' then 'UT'
               when lower(trim(state)) = '{value: va}' then 'VA'
               when lower(trim(state)) = '{value: wa}' then 'WA'
               when lower(trim(state)) = '{value: wi}' then 'WI'
               when lower(trim(state)) = '{value: wv}' then 'WV'
               when lower(trim(state)) = '{value: wy}' then 'WY'
               when lower(trim(state)) = 'va virginia' then 'VA'
               when lower(trim(state)) = 'va - virginia' then 'VA'
               when lower(trim(state)) = 'vermont' then 'VT'
               when lower(trim(state)) = 'virgina' then 'VA'
               when lower(trim(state)) = 'virgini' then 'VA'
               when lower(trim(state)) = 'virginia, hickory high school' then 'VA'
               when lower(trim(state)) = 'virginia' then 'VA'
               when lower(trim(state)) = 'virginia va' then 'VA'
               when lower(trim(state)) = 'virginia (va)' then 'VA'
               when lower(trim(state)) = 'virgnia' then 'VA'
               when lower(trim(state)) = 'west virginia' then 'WV'
               when lower(trim(state)) = 'wisc' then 'WI'
               when lower(trim(state)) = 'wisconsin' then 'WI'
               when lower(trim(state)) = 'wi - wisconsin' then 'WI'
               when lower(trim(state)) = 'wyom' then 'WY'
               when lower(trim(state)) = 'wyoming' then 'WY'
               when lower(trim(state)) = 'puerto rico' then 'PR'
               when lower(trim(state)) = 'pr' then 'WY'
               when lower(trim(state)) = 'washington' then 'WA'
               when lower(trim(state)) = 'pennsylvania' then 'PA'
               when lower(trim(state)) = 'alaska' then 'AK'
               else lower(trim(state)) end as Formatted_State,
       zipcode,
       country,
       language,
       cio_status,
       cio_status_timestamp,
       sms_status,
       source_detail,
       utm_medium,
       utm_source,
       utm_campaign,
       contentful_id,
       legacy_badges_flag,
       badges,
       total_badges,
       refer_friends,
       refer_friends_scholarship,
       subscribed_member,
       last_updated_at,
       school_id,
       causes,
       referrer_user_id
from users;


--count of users by state
with userstatecount as (
    Select northstar_id,
           case
               when lower(trim(state)) = 'al - alabama' then 'AL'
               when lower(trim(state)) = 'alabama' then 'AL'
               when lower(trim(state)) = 'ariz' then 'AZ'
               when lower(trim(state)) = 'arizon' then 'AZ'
               when lower(trim(state)) = 'arizona' then 'AZ'
               when lower(trim(state)) = 'az -' then 'AZ'
               when lower(trim(state)) = 'az.' then 'AZ'
               when lower(trim(state)) = 'az' then 'AZ'
               when lower(trim(state)) = 'az - arizona' then 'AZ'
               when lower(trim(state)) = 'arkansas' then 'AR'
               when lower(trim(state)) = 'arka' then 'AR'
               when lower(trim(state)) = 'ark' then 'AR'
               when lower(trim(state)) = 'ca - california' then 'CA'
               when lower(trim(state)) = 'ca - california [usa]' then 'CA'
               when lower(trim(state)) = 'ca-c' then 'CA'
               when lower(trim(state)) = 'ca' then 'CA'
               when lower(trim(state)) = 'ca.' then 'CA'
               when lower(trim(state)) = 'ca -' then 'CA'
               when lower(trim(state)) = 'cali' then 'CA'
               when lower(trim(state)) = 'calif' then 'CA'
               when lower(trim(state)) = 'california' then 'CA'
               when lower(trim(state)) = 'califorinia' then 'CA'
               when lower(trim(state)) = 'californa' then 'CA'
               when lower(trim(state)) = 'californi' then 'CA'
               when lower(trim(state)) = 'califorina' then 'CA'
               when lower(trim(state)) = 'california ca' then 'CA'
               when lower(trim(state)) = 'califronia' then 'CA'
               when lower(trim(state)) = 'carlifornia' then 'CA'
               when lower(trim(state)) = 'california (ca)' then 'CA'
               when lower(trim(state)) = 'ca   -   californi' then 'CA'
               when lower(trim(state)) = 'connecticurt' then 'CT'
               when lower(trim(state)) = 'connecticut' then 'CT'
               when lower(trim(state)) = 'conneticut' then 'CT'
               when lower(trim(state)) = 'co' then 'CO'
               when lower(trim(state)) = 'co -' then 'CO'
               when lower(trim(state)) = 'co.' then 'CO'
               when lower(trim(state)) = 'colorado' then 'CO'
               when lower(trim(state)) = 'delaware' then 'DE'
               when lower(trim(state)) = 'guam' then 'GU'
               when lower(trim(state)) = 'district of columbia' then 'DC'
               when lower(trim(state)) = 'fl' then 'FL'
               when lower(trim(state)) = 'fl -' then 'FL'
               when lower(trim(state)) = 'fl.' then 'FL'
               when lower(trim(state)) = 'fl florida' then 'FL'
               when lower(trim(state)) = 'fl - florida' then 'FL'
               when lower(trim(state)) = 'fl: florida' then 'FL'
               when lower(trim(state)) = 'flor' then 'FL'
               when lower(trim(state)) = 'flordia' then 'FL'
               when lower(trim(state)) = 'florida' then 'FL'
               when lower(trim(state)) = 'florida fl' then 'FL'
               when lower(trim(state)) = 'fl florida (fl)' then 'FL'
               when lower(trim(state)) = 'ga - georgia' then 'GA'
               when lower(trim(state)) = 'ga' then 'GA'
               when lower(trim(state)) = 'ga -' then 'GA'
               when lower(trim(state)) = 'georgia' then 'GA'
               when lower(trim(state)) = 'ga - georgia' then 'GA'
               when lower(trim(state)) = 'ga - georgia' then 'GA'
               when lower(trim(state)) = 'hawalli' then 'HI'
               when lower(trim(state)) = 'hawaii' then 'HI'
               when lower(trim(state)) = 'hi - hawaii' then 'HI'
               when lower(trim(state)) = 'hi - hawaii [usa]' then 'HI'
               when lower(trim(state)) = 'hawaii' then 'HI'
               when lower(trim(state)) = 'hawaii' then 'HI'
               when lower(trim(state)) = 'idaho' then 'ID'
               when lower(trim(state)) = 'idah' then 'ID'
               when lower(trim(state)) = 'iowa' then 'IA'
               when lower(trim(state)) = 'il - illinois' then 'IL'
               when lower(trim(state)) = 'il-illinois' then 'IL'
               when lower(trim(state)) = 'illinios' then 'IL'
               when lower(trim(state)) = 'illinoi' then 'IL'
               when lower(trim(state)) = 'illinois' then 'IL'
               when lower(trim(state)) = 'illinoise' then 'IL'
               when lower(trim(state)) = 'illinois il' then 'IL'
               when lower(trim(state)) = 'illinois' then 'IL'
               when lower(trim(state)) = 'indiana' then 'IN'
               when lower(trim(state)) = 'indiana' then 'IN'
               when lower(trim(state)) = 'in - indiana' then 'IN'
               when lower(trim(state)) = 'indiana (in)' then 'IN'
               when lower(trim(state)) = 'kentucky' then 'KY'
               when lower(trim(state)) = 'kentucky (ky)' then 'KY'
               when lower(trim(state)) = 'kansas' then 'KS'
               when lower(trim(state)) = 'kansas [ks]' then 'KS'
               when lower(trim(state)) = 'la - louisiana' then 'LA'
               when lower(trim(state)) = 'louisianna' then 'LA'
               when lower(trim(state)) = 'lousiiana' then 'LA'
               when lower(trim(state)) = 'louisisana' then 'LA'
               when lower(trim(state)) = 'lousiana' then 'LA'
               when lower(trim(state)) = 'louisiana' then 'LA'
               when lower(trim(state)) = 'Iowa' then 'IA'
               when lower(trim(state)) = 'massachussetts' then 'MA'
               when lower(trim(state)) = 'massachusetts' then 'MA'
               when lower(trim(state)) = 'maryland' then 'MD'
               when lower(trim(state)) = 'maryland md' then 'MD'
               when lower(trim(state)) = 'maryland (md)' then 'MD'
               when lower(trim(state)) = 'marylang' then 'MD'
               when lower(trim(state)) = 'md - maryland' then 'MD'
               when lower(trim(state)) = 'md - maryland [usa]' then 'MD'
               when lower(trim(state)) = 'michigan' then 'MI'
               when lower(trim(state)) = 'michian' then 'MI'
               when lower(trim(state)) = 'michigan' then 'MI'
               when lower(trim(state)) = 'michigan (mi)' then 'MI'
               when lower(trim(state)) = 'michigan [mi]' then 'MI'
               when lower(trim(state)) = 'mn - minnesota' then 'MN'
               when lower(trim(state)) = 'minnesota' then 'MN'
               when lower(trim(state)) = 'minnesota (mn)' then 'MN'
               when lower(trim(state)) = 'missisippi' then 'MP'
               when lower(trim(state)) = 'ms - mississippi' then 'MP'
               when lower(trim(state)) = 'mississippi' then 'MP'
               when lower(trim(state)) = 'misouri' then 'MS'
               when lower(trim(state)) = 'missouri' then 'MS'
               when lower(trim(state)) = 'mo - missouri' then 'MS'
               when lower(trim(state)) = 'mt' then 'MT'
               when lower(trim(state)) = 'mt - montana' then 'MT'
               when lower(trim(state)) = 'montana' then 'MT'
               when lower(trim(state)) = 'maine' then 'ME'
               when lower(trim(state)) = 'n.c' then 'NC'
               when lower(trim(state)) = 'n.c.' then 'NC'
               when lower(trim(state)) = 'n. carolina' then 'NC'
               when lower(trim(state)) = 'nc - north carolina' then 'NC'
               when lower(trim(state)) = 'nc north carolina' then 'NC'
               when lower(trim(state)) = 'nebraska' then 'NE'
               when lower(trim(state)) = 'nd - north dakota' then 'ND'
               when lower(trim(state)) = 'ne -' then 'NE'
               when lower(trim(state)) = 'new hampshire' then 'NH'
               when lower(trim(state)) = 'n.dak' then 'ND'
               when lower(trim(state)) = 'nevada' then 'NV'
               when lower(trim(state)) = 'newjersey' then 'NJ'
               when lower(trim(state)) = 'new jersey' then 'NJ'
               when lower(trim(state)) = 'new-jersey' then 'NJ'
               when lower(trim(state)) = 'new jersey (nj)' then 'NJ'
               when lower(trim(state)) = 'new mexcio' then 'NM'
               when lower(trim(state)) = 'new mexico' then 'NM'
               when lower(trim(state)) = 'new mexico (nm)' then 'NM'
               when lower(trim(state)) = 'newyork' then 'NY'
               when lower(trim(state)) = 'new york' then 'NY'
               when lower(trim(state)) = 'new york (ny)' then 'NY'
               when lower(trim(state)) = 'new mexico' then 'NM'
               when lower(trim(state)) = 'n.h.' then 'NH'
               when lower(trim(state)) = 'nh -' then 'NH'
               when lower(trim(state)) = 'nh - new hampshire' then 'NH'
               when lower(trim(state)) = 'nj - new jersey' then 'NJ'
               when lower(trim(state)) = 'nj-new jersey' then 'NJ'
               when lower(trim(state)) = 'nm - new mexico' then 'NM'
               when lower(trim(state)) = 'north caralina' then 'NC'
               when lower(trim(state)) = 'north carolina' then 'NC'
               when lower(trim(state)) = 'north carolina nc' then 'NC'
               when lower(trim(state)) = 'north carolina (nc)' then 'NC'
               when lower(trim(state)) = 'north carolinas' then 'NC'
               when lower(trim(state)) = 'north caroline' then 'NC'
               when lower(trim(state)) = 'north carolinia' then 'NC'
               when lower(trim(state)) = 'north dakota' then 'ND'
               when lower(trim(state)) = 'ny - new york' then 'NY'
               when lower(trim(state)) = 'ny new york' then 'NY'
               when lower(trim(state)) = 'oh -' then 'OH'
               when lower(trim(state)) = 'ohio' then 'OH'
               when lower(trim(state)) = 'ohio oh' then 'OH'
               when lower(trim(state)) = 'ohip' then 'OH'
               when lower(trim(state)) = 'oh ohio' then 'OH'
               when lower(trim(state)) = 'oh - ohio' then 'OH'
               when lower(trim(state)) = 'ok -' then 'OK'
               when lower(trim(state)) = 'okahoma' then 'OK'
               when lower(trim(state)) = 'oklahoma' then 'OK'
               when lower(trim(state)) = 'oklahoma (ok)' then 'OK'
               when lower(trim(state)) = 'ok - oklahoma' then 'OK'
               when lower(trim(state)) = 'oregon' then 'OR'
               when lower(trim(state)) = 'or' then 'OR'
               when lower(trim(state)) = 'or - oregon' then 'OR'
               when lower(trim(state)) = 'pa - pennsylvania' then 'PA'
               when lower(trim(state)) = 'pa - pennsylvania [usa]' then 'PA'
               when lower(trim(state)) = 'pennslyvania' then 'PA'
               when lower(trim(state)) = 'pennsylvaia' then 'PA'
               when lower(trim(state)) = 'pennsylvainia' then 'PA'
               when lower(trim(state)) = 'pennsylvania (pa)' then 'PA'
               when lower(trim(state)) = 'pennsylvannia' then 'PA'
               when lower(trim(state)) = 'pennsylvvania' then 'PA'
               when lower(trim(state)) = 'rhode island' then 'RI'
               when lower(trim(state)) = 'rhode island ri' then 'RI'
               when lower(trim(state)) = 'ri - rhode island' then 'RI'
               when lower(trim(state)) = 'south caorlina' then 'SC'
               when lower(trim(state)) = 'south carolina' then 'SC'
               when lower(trim(state)) = 'south dakota' then 'SD'
               when lower(trim(state)) = 'teas' then 'TX'
               when lower(trim(state)) = 'teaxas' then 'TX'
               when lower(trim(state)) = 'tenessee' then 'TN'
               when lower(trim(state)) = 'tenn' then 'TN'
               when lower(trim(state)) = 'tennessee' then 'TN'
               when lower(trim(state)) = 'tennesse' then 'TN'
               when lower(trim(state)) = 'tennessee (tn)' then 'TN'
               when lower(trim(state)) = 'texa' then 'TX'
               when lower(trim(state)) = 'texas' then 'TX'
               when lower(trim(state)) = 'texastx' then 'TX'
               when lower(trim(state)) = 'texas tx' then 'TX'
               when lower(trim(state)) = 'texas / tx' then 'TX'
               when lower(trim(state)) = 'texas (tx)' then 'TX'
               when lower(trim(state)) = 'tx -' then 'TX'
               when lower(trim(state)) = 'tx' then 'TX'
               when lower(trim(state)) = 'tx-t' then 'TX'
               when lower(trim(state)) = 'txg' then 'TX'
               when lower(trim(state)) = 'tx texas' then 'TX'
               when lower(trim(state)) = 'tx - texas' then 'TX'
               when lower(trim(state)) = 'tx (texas)' then 'TX'
               when lower(trim(state)) = 'tx-texas' then 'TX'
               when lower(trim(state)) = 'tx - texas [usa]' then 'TX'
               when lower(trim(state)) = 'tx w' then 'TX'
               when lower(trim(state)) = 'twxas' then 'TX'
               when lower(trim(state)) = 'texas' then 'TX'
               when lower(trim(state)) = 'utah' then 'UT'
               when lower(trim(state)) = 'utah (ut)' then 'UT'
               when lower(trim(state)) = '{value: al}' then 'AL'
               when lower(trim(state)) = '{value: ar}' then 'AR'
               when lower(trim(state)) = '{value: az}' then 'AZ'
               when lower(trim(state)) = '{value: ca}' then 'CA'
               when lower(trim(state)) = '{value: co}' then 'CO'
               when lower(trim(state)) = '{value: ct}' then 'CT'
               when lower(trim(state)) = '{value: de}' then 'DE'
               when lower(trim(state)) = '{value: fl}' then 'FL'
               when lower(trim(state)) = '{value: ga}' then 'GA'
               when lower(trim(state)) = '{value: ia}' then 'IA'
               when lower(trim(state)) = '{value: il}' then 'IL'
               when lower(trim(state)) = '{value: in}' then 'IN'
               when lower(trim(state)) = '{value: ks}' then 'KS'
               when lower(trim(state)) = '{value: ky}' then 'KY'
               when lower(trim(state)) = '{value: la}' then 'LA'
               when lower(trim(state)) = '{value: ma}' then 'MA'
               when lower(trim(state)) = '{value: md}' then 'MD'
               when lower(trim(state)) = '{value: mi}' then 'MI'
               when lower(trim(state)) = '{value: mn}' then 'MN'
               when lower(trim(state)) = '{value: mo}' then 'MO'
               when lower(trim(state)) = '{value: ms}' then 'MS'
               when lower(trim(state)) = '{value: nc}' then 'NC'
               when lower(trim(state)) = '{value: ne}' then 'NE'
               when lower(trim(state)) = '{value: nj}' then 'NJ'
               when lower(trim(state)) = '{value: nv}' then 'NV'
               when lower(trim(state)) = '{value: ny}' then 'NY'
               when lower(trim(state)) = '{value: oh}' then 'OH'
               when lower(trim(state)) = '{value: ok}' then 'OK'
               when lower(trim(state)) = '{value: or}' then 'OR'
               when lower(trim(state)) = '{value: pa}' then 'PA'
               when lower(trim(state)) = '{value: sc}' then 'SC'
               when lower(trim(state)) = '{value: sd}' then 'SD'
               when lower(trim(state)) = '{value: tn}' then 'TN'
               when lower(trim(state)) = '{value: tx}' then 'TX'
               when lower(trim(state)) = '{value: ut}' then 'UT'
               when lower(trim(state)) = '{value: va}' then 'VA'
               when lower(trim(state)) = '{value: wa}' then 'WA'
               when lower(trim(state)) = '{value: wi}' then 'WI'
               when lower(trim(state)) = '{value: wv}' then 'WV'
               when lower(trim(state)) = '{value: wy}' then 'WY'
               when lower(trim(state)) = 'va virginia' then 'VA'
               when lower(trim(state)) = 'va - virginia' then 'VA'
               when lower(trim(state)) = 'vermont' then 'VT'
               when lower(trim(state)) = 'virgina' then 'VA'
               when lower(trim(state)) = 'virgini' then 'VA'
               when lower(trim(state)) = 'virginia, hickory high school' then 'VA'
               when lower(trim(state)) = 'virginia' then 'VA'
               when lower(trim(state)) = 'virginia va' then 'VA'
               when lower(trim(state)) = 'virginia (va)' then 'VA'
               when lower(trim(state)) = 'virgnia' then 'VA'
               when lower(trim(state)) = 'west virginia' then 'WV'
               when lower(trim(state)) = 'wisc' then 'WI'
               when lower(trim(state)) = 'wisconsin' then 'WI'
               when lower(trim(state)) = 'wi - wisconsin' then 'WI'
               when lower(trim(state)) = 'wyom' then 'WY'
               when lower(trim(state)) = 'wyoming' then 'WY'
               when lower(trim(state)) = 'puerto rico' then 'PR'
               when lower(trim(state)) = 'pr' then 'WY'
               when lower(trim(state)) = 'washington' then 'WA'
               when lower(trim(state)) = 'pennsylvania' then 'PA'
               when lower(trim(state)) = 'alaska' then 'AK'
               else UPPER(trim(state)) end as Formatted_State
    from users)

select count(distinct northstar_id), upper(Formatted_State)
from userstatecount
group by upper(Formatted_State)
order by count(distinct northstar_id) desc


